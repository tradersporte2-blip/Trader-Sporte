<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trader Sporte - Painel Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css">
    <style>
        :root {
            --primary: #FF4757;
            --primary-dark: #FF3742;
            --secondary: #2ED573;
            --success: #2ED573;
            --danger: #FF4757;
            --warning: #FFA502;
            --info: #1E90FF;
            --dark-bg: #0A0E17;
            --card-bg: #131B2E;
            --sidebar-bg: #0D1424;
            --chart-bg: #1A2332;
            --text-light: #FFFFFF;
            --text-gray: #8C9CB0;
            --border-color: rgba(255, 255, 255, 0.1);
            --robot-color: #9D50BB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
        }

        /* Login */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #0A0E17 0%, #1A2332 100%);
            padding: 20px;
        }

        .login-box {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            border: 1px solid var(--border-color);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-logo {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: var(--text-gray);
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-light);
            font-weight: 500;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 14px;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 71, 87, 0.05);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-robot {
            background: var(--robot-color);
            color: white;
        }

        .btn-robot:hover {
            background: #8B46AA;
            transform: translateY(-2px);
        }

        .btn-robot.active {
            background: var(--robot-color);
            box-shadow: 0 0 15px rgba(157, 80, 187, 0.5);
        }

        .btn-full {
            width: 100%;
        }

        /* Dashboard */
        .dashboard {
            display: none;
        }

        .header {
            background: var(--card-bg);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: var(--primary);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .profit-badge {
            background: rgba(46, 213, 115, 0.1);
            border: 1px solid rgba(46, 213, 115, 0.3);
            border-radius: 8px;
            padding: 8px 16px;
            font-weight: 600;
        }

        .profit-amount {
            color: var(--success);
        }

        .main-container {
            display: flex;
            min-height: calc(100vh - 70px);
        }

        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
        }

        .nav-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-light);
        }

        .nav-item.active {
            background: rgba(255, 71, 87, 0.1);
            border-left-color: var(--primary);
            color: var(--primary);
        }

        .content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--text-light);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-label {
            color: var(--text-gray);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-light);
        }

        /* Chart Mode Control - MODIFICADO */
        .chart-mode-control {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .mode-toggle {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .mode-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: transparent;
            color: var(--text-gray);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 180px;
        }

        .mode-btn:hover {
            border-color: var(--primary);
            color: var(--text-light);
        }

        .mode-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .mode-btn.robot.active {
            background: var(--robot-color);
            border-color: var(--robot-color);
        }

        .mode-btn .live-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 1.5s infinite;
        }

        .mode-btn .robot-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--robot-color);
            animation: pulse-robot 1s infinite;
        }

        @keyframes pulse-robot {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        /* Robot Control Panel - NOVO */
        .robot-control-panel {
            background: rgba(157, 80, 187, 0.1);
            border: 2px solid var(--robot-color);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            display: none;
        }

        .robot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .robot-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--robot-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .robot-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
        }

        .robot-status.active {
            background: rgba(46, 213, 115, 0.2);
            color: var(--success);
            border: 1px solid rgba(46, 213, 115, 0.3);
        }

        .robot-status.inactive {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
            border: 1px solid rgba(255, 71, 87, 0.3);
        }

        .robot-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .robot-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .robot-stat-label {
            font-size: 12px;
            color: var(--text-gray);
            margin-bottom: 8px;
        }

        .robot-stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-light);
        }

        .robot-stat.up {
            color: var(--success);
        }

        .robot-stat.down {
            color: var(--danger);
        }

        .robot-stat.net {
            color: var(--robot-color);
        }

        .robot-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Chart Section */
        .chart-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .chart-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-label {
            color: var(--text-gray);
            font-size: 14px;
        }

        .select-control {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-light);
            min-width: 150px;
        }

        .chart-container {
            height: 400px;
            position: relative;
            background: var(--chart-bg);
            border-radius: 8px;
            padding: 15px;
        }

        /* Profit/Loss Stats */
        .profit-loss-stats {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .profit-loss-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .profit-loss-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .profit-loss-title {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 10px;
        }

        .profit-loss-value {
            font-size: 28px;
            font-weight: 700;
        }

        .profit-card {
            color: var(--success);
            border-color: rgba(46, 213, 115, 0.3);
        }

        .loss-card {
            color: var(--danger);
            border-color: rgba(255, 71, 87, 0.3);
        }

        .total-card {
            color: var(--info);
            border-color: rgba(30, 144, 255, 0.3);
        }

        /* Lists */
        .list-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            max-height: 500px;
            overflow-y: auto;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .list-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-light);
        }

        .list-count {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .list-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .list-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            font-size: 24px;
            cursor: pointer;
        }

        .modal-close:hover {
            color: var(--text-light);
        }

        /* Trading Controls */
        .trading-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-panel {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }

        .control-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-light);
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .price-display {
            text-align: center;
            margin: 20px 0;
        }

        .current-price {
            font-size: 48px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 10px;
        }

        .price-label {
            color: var(--text-gray);
            font-size: 14px;
        }

        .direction-controls {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .direction-btn {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .up-btn {
            background: linear-gradient(135deg, var(--success), #26C165);
            color: white;
        }

        .down-btn {
            background: linear-gradient(135deg, var(--danger), #E63E4D);
            color: white;
        }

        .direction-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .direction-btn:active {
            transform: translateY(-1px);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 10000;
            font-weight: 600;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
            backdrop-filter: blur(10px);
        }

        .notification.success {
            background: rgba(46, 213, 115, 0.9);
            color: white;
            border-left: 4px solid #26C165;
        }

        .notification.error {
            background: rgba(255, 71, 87, 0.9);
            color: white;
            border-left: 4px solid #E63E4D;
        }

        .notification.warning {
            background: rgba(255, 165, 2, 0.9);
            color: black;
            border-left: 4px solid #E69500;
        }

        .notification.robot {
            background: rgba(157, 80, 187, 0.9);
            color: white;
            border-left: 4px solid #8B46AA;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Animações */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .trading-controls {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: fixed;
                left: -260px;
                top: 70px;
                height: calc(100vh - 70px);
                z-index: 1000;
                transition: left 0.3s ease;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .content {
                margin-left: 0;
            }
            
            .mode-toggle {
                flex-direction: column;
            }
            
            .mode-btn {
                min-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .profit-loss-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .chart-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .direction-controls {
                flex-direction: column;
            }
            
            .robot-stats {
                grid-template-columns: 1fr;
            }
            
            .robot-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <div class="login-logo">TRADER SPORTE</div>
                <div class="login-subtitle">Painel Administrativo</div>
            </div>
            
            <div class="input-group">
                <label class="input-label">ID Admin</label>
                <input type="text" class="input-field" id="adminId" placeholder="1975">
            </div>
            
            <div class="input-group">
                <label class="input-label">Senha Admin</label>
                <input type="password" class="input-field" id="adminPassword" placeholder="200718">
            </div>
            
            <button class="btn btn-primary btn-full" onclick="adminLogin()">
                <i class="fas fa-sign-in-alt"></i>
                ACESSAR PAINEL
            </button>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="adminDashboard" class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="logo-text">TRADER SPORTE ADMIN</div>
            </div>
            
            <div class="admin-info">
                <div class="profit-badge">
                    LUCRO TOTAL: <span class="profit-amount" id="adminProfit">0</span> Kz
                </div>
                <button class="btn btn-primary" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> SAIR
                </button>
            </div>
        </header>

        <div class="main-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                    <span class="notification-badge" id="dashboardNotifications" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('trading')">
                    <i class="fas fa-chart-line"></i>
                    Controle Trading
                </div>
                <div class="nav-item" onclick="showSection('robot')">
                    <i class="fas fa-robot"></i>
                    Controle Robô
                    <span class="notification-badge" id="robotNotifications" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('users')">
                    <i class="fas fa-users"></i>
                    Usuários
                    <span class="notification-badge" id="usersNotifications" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('deposits')">
                    <i class="fas fa-money-bill-wave"></i>
                    Depósitos
                    <span class="notification-badge" id="depositsNotifications" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('withdrawals')">
                    <i class="fas fa-wallet"></i>
                    Saques
                    <span class="notification-badge" id="withdrawalsNotifications" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('profits')">
                    <i class="fas fa-chart-pie"></i>
                    Lucros/Perdas
                </div>
                <div class="nav-item" onclick="showSection('notifications')">
                    <i class="fas fa-bell"></i>
                    Notificações
                    <span class="notification-badge" id="notificationsBadge" style="display: none;"></span>
                </div>
                <div class="nav-item" onclick="showSection('adminWallet')">
                    <i class="fas fa-vault"></i>
                    Carteira Admin
                </div>
            </aside>

            <!-- Main Content -->
            <main class="content">
                <!-- Dashboard Section -->
                <section id="dashboardSection">
                    <h2 class="page-title">Dashboard Administrativo</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card" onclick="showSection('users')">
                            <div class="stat-icon" style="background: rgba(46, 213, 115, 0.1); color: var(--success);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Total Usuários</div>
                                <div class="stat-value" id="statUsers">0</div>
                            </div>
                        </div>
                        
                        <div class="stat-card" onclick="showSection('deposits')">
                            <div class="stat-icon" style="background: rgba(30, 144, 255, 0.1); color: var(--info);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Depósitos Pendentes</div>
                                <div class="stat-value" id="statDeposits">0</div>
                            </div>
                        </div>
                        
                        <div class="stat-card" onclick="showSection('withdrawals')">
                            <div class="stat-icon" style="background: rgba(255, 165, 2, 0.1); color: var(--warning);">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Saques Pendentes</div>
                                <div class="stat-value" id="statWithdrawals">0</div>
                            </div>
                        </div>
                        
                        <div class="stat-card" onclick="showSection('profits')">
                            <div class="stat-icon" style="background: rgba(255, 71, 87, 0.1); color: var(--primary);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Lucro Total</div>
                                <div class="stat-value" id="statProfitTotal">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Chart Mode Control - MODIFICADO -->
                    <div class="chart-mode-control">
                        <h3 style="color: var(--text-light); margin-bottom: 10px;">Modo do Gráfico</h3>
                        <p style="color: var(--text-gray); font-size: 14px; margin-bottom: 15px;">
                            Escolha entre modo manual, tempo real ou robô automático
                        </p>
                        <div class="mode-toggle">
                            <button class="mode-btn active" id="manualModeBtn">
                                <i class="fas fa-hand-paper"></i>
                                Modo Manual
                            </button>
                            <button class="mode-btn" id="realModeBtn">
                                <i class="fas fa-bolt"></i>
                                Modo Real
                                <span class="live-indicator"></span>
                            </button>
                            <button class="mode-btn robot" id="robotModeBtn">
                                <i class="fas fa-robot"></i>
                                Modo Robô
                                <span class="robot-indicator"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Robot Control Panel - NOVO -->
                    <div class="robot-control-panel" id="robotControlPanel">
                        <div class="robot-header">
                            <div class="robot-title">
                                <i class="fas fa-robot"></i>
                                Controle do Robô Automático
                            </div>
                            <div class="robot-status inactive" id="robotStatus">
                                DESLIGADO
                            </div>
                        </div>
                        
                        <div class="robot-stats">
                            <div class="robot-stat">
                                <div class="robot-stat-label">Total Apostado (UP)</div>
                                <div class="robot-stat-value up" id="robotTotalUp">0 Kz</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Total Apostado (DOWN)</div>
                                <div class="robot-stat-value down" id="robotTotalDown">0 Kz</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Balanço</div>
                                <div class="robot-stat-value net" id="robotBalance">0 Kz</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Direção Atual</div>
                                <div class="robot-stat-value" id="robotDirection">-</div>
                            </div>
                        </div>
                        
                        <div class="robot-controls">
                            <button class="btn btn-robot" id="startRobotBtn" onclick="startRobot()">
                                <i class="fas fa-play"></i> LIGAR ROBÔ
                            </button>
                            <button class="btn" id="stopRobotBtn" onclick="stopRobot()" disabled
                                    style="background: rgba(255, 71, 87, 0.1); color: var(--danger);">
                                <i class="fas fa-stop"></i> PARAR ROBÔ
                            </button>
                            <button class="btn" id="analyzeBtn" onclick="analyzeMarket()"
                                    style="background: rgba(30, 144, 255, 0.1); color: var(--info);">
                                <i class="fas fa-chart-bar"></i> ANALISAR MERCADO
                            </button>
                            <button class="btn" id="autoBalanceBtn" onclick="autoBalanceMarket()"
                                    style="background: rgba(46, 213, 115, 0.1); color: var(--success);">
                                <i class="fas fa-balance-scale"></i> BALANCEAR
                            </button>
                        </div>
                        
                        <div style="margin-top: 20px; font-size: 12px; color: var(--text-gray);">
                            <i class="fas fa-info-circle"></i> O robô analisa o balanço total das apostas e ajusta o gráfico automaticamente para maximizar os lucros da casa.
                        </div>
                    </div>

                    <!-- Chart -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3 style="color: var(--text-light);">Gráfico em Tempo Real</h3>
                            <div class="chart-controls">
                                <div class="control-group">
                                    <span class="control-label">Operação:</span>
                                    <select class="select-control" id="chartAsset">
                                        <option value="POP1">PREMIER OPERATION</option>
                                        <option value="BOP1">BANTU OPERATION</option>
                                        <option value="EOP1">888 OPERATION</option>
                                        <option value="SOP1">SPORT OPERATION</option>
                                    </select>
                                </div>
                                
                                <div class="control-group">
                                    <span class="control-label">Timeframe:</span>
                                    <select class="select-control" id="chartTimeframe">
                                        <option value="15s">15 segundos</option>
                                        <option value="30s">30 segundos</option>
                                        <option value="1m">1 minuto</option>
                                        <option value="5m">5 minutos</option>
                                        <option value="15m">15 minutos</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="adminChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Trading Control Section -->
                <section id="tradingSection" style="display: none;">
                    <h2 class="page-title">Controle de Trading</h2>
                    
                    <div class="trading-controls">
                        <div class="control-panel">
                            <div class="control-title">Controle Manual</div>
                            
                            <div class="price-display">
                                <div class="current-price" id="currentPrice">150.50</div>
                                <div class="price-label" id="currentAssetName">PREMIER OPERATION</div>
                            </div>
                            
                            <div class="direction-controls">
                                <button class="direction-btn up-btn" id="upBtn">
                                    <i class="fas fa-arrow-up"></i>
                                    SUBIR
                                </button>
                                <button class="direction-btn down-btn" id="downBtn">
                                    <i class="fas fa-arrow-down"></i>
                                    DESCER
                                </button>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <div class="control-label">Valor de Mudança:</div>
                                <input type="number" class="input-field" id="changeValue" value="1.5" min="0.1" step="0.1">
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-title">Configurações do Sistema</div>
                            
                            <div style="margin-bottom: 20px;">
                                <div class="control-label">Status do Trading:</div>
                                <div style="display: flex; gap: 10px; margin-top: 10px;">
                                    <button class="mode-btn active" id="tradingOnBtn">
                                        <i class="fas fa-play"></i> ATIVO
                                    </button>
                                    <button class="mode-btn" id="tradingOffBtn">
                                        <i class="fas fa-pause"></i> PAUSADO
                                    </button>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <div class="control-label">Operações Disponíveis:</div>
                                <div id="operationsList" style="margin-top: 10px;"></div>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <button class="btn btn-primary btn-full" onclick="saveTradingConfig()">
                                    <i class="fas fa-save"></i> SALVAR CONFIGURAÇÕES
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3 style="color: var(--text-light);">Gráfico de Controle</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="controlChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Robot Control Section - NOVO -->
                <section id="robotSection" style="display: none;">
                    <h2 class="page-title">Controle do Robô Automático</h2>
                    
                    <div class="robot-control-panel" style="display: block; border-color: var(--robot-color);">
                        <div class="robot-header">
                            <div class="robot-title">
                                <i class="fas fa-robot"></i>
                                Sistema de Controle Automático
                            </div>
                            <div class="robot-status inactive" id="robotSectionStatus">
                                DESLIGADO
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <p style="color: var(--text-gray); font-size: 14px;">
                                <strong>Como funciona:</strong> O robô analisa todas as apostas ativas em tempo real. Quando o total apostado em UP é maior, o gráfico DESCE para que a casa ganhe. Quando o total em DOWN é maior, o gráfico SOBE.
                            </p>
                        </div>
                        
                        <div class="robot-stats">
                            <div class="robot-stat">
                                <div class="robot-stat-label">Apostas UP Ativas</div>
                                <div class="robot-stat-value up" id="activeUpTrades">0</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Apostas DOWN Ativas</div>
                                <div class="robot-stat-value down" id="activeDownTrades">0</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Valor UP Ativo</div>
                                <div class="robot-stat-value up" id="activeUpAmount">0 Kz</div>
                            </div>
                            <div class="robot-stat">
                                <div class="robot-stat-label">Valor DOWN Ativo</div>
                                <div class="robot-stat-value down" id="activeDownAmount">0 Kz</div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px; margin: 20px 0;">
                            <h4 style="color: var(--text-light); margin-bottom: 10px;">Configurações do Robô</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div>
                                    <label style="display: block; color: var(--text-gray); font-size: 12px; margin-bottom: 5px;">Força do Movimento</label>
                                    <input type="range" min="0.1" max="5" step="0.1" value="1.5" class="input-field" id="robotStrength" style="width: 100%;">
                                    <div style="font-size: 11px; color: var(--text-gray); text-align: center;" id="robotStrengthValue">1.5</div>
                                </div>
                                <div>
                                    <label style="display: block; color: var(--text-gray); font-size: 12px; margin-bottom: 5px;">Intervalo (segundos)</label>
                                    <input type="number" min="1" max="60" value="3" class="input-field" id="robotInterval" style="width: 100%;">
                                </div>
                                <div>
                                    <label style="display: block; color: var(--text-gray); font-size: 12px; margin-bottom: 5px;">Sensibilidade (%)</label>
                                    <input type="number" min="1" max="100" value="10" class="input-field" id="robotSensitivity" style="width: 100%;">
                                </div>
                                <div>
                                    <label style="display: block; color: var(--text-gray); font-size: 12px; margin-bottom: 5px;">Modo</label>
                                    <select class="input-field" id="robotMode" style="width: 100%;">
                                        <option value="aggressive">Agressivo</option>
                                        <option value="balanced" selected>Balanceado</option>
                                        <option value="conservative">Conservador</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="robot-controls">
                            <button class="btn btn-robot" id="robotSectionStartBtn" onclick="startRobot()">
                                <i class="fas fa-play"></i> LIGAR ROBÔ
                            </button>
                            <button class="btn" id="robotSectionStopBtn" onclick="stopRobot()" disabled
                                    style="background: rgba(255, 71, 87, 0.1); color: var(--danger);">
                                <i class="fas fa-stop"></i> PARAR ROBÔ
                            </button>
                            <button class="btn" id="robotForceDown" onclick="forceRobotDirection('down')"
                                    style="background: rgba(255, 71, 87, 0.1); color: var(--danger);">
                                <i class="fas fa-arrow-down"></i> FORÇAR DESCER
                            </button>
                            <button class="btn" id="robotForceUp" onclick="forceRobotDirection('up')"
                                    style="background: rgba(46, 213, 115, 0.1); color: var(--success);">
                                <i class="fas fa-arrow-up"></i> FORÇAR SUBIR
                            </button>
                        </div>
                    </div>
                    
                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-title">Log do Robô</div>
                        <div id="robotLog" style="max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
                    </div>
                </section>

                <!-- Users Section -->
                <section id="usersSection" style="display: none;">
                    <h2 class="page-title">Gestão de Usuários</h2>
                    <div class="list-container">
                        <div class="list-header">
                            <div class="list-title">Todos os Usuários</div>
                            <div class="list-count" id="usersCount">0</div>
                        </div>
                        <div id="usersList"></div>
                    </div>
                </section>

                <!-- Deposits Section -->
                <section id="depositsSection" style="display: none;">
                    <h2 class="page-title">Gestão de Depósitos</h2>
                    <div class="list-container">
                        <div class="list-header">
                            <div class="list-title">Depósitos Pendentes</div>
                            <div class="list-count" id="depositsCount">0</div>
                        </div>
                        <div id="depositsList"></div>
                    </div>
                    
                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-title">Histórico de Depósitos</div>
                        <div id="depositsHistory"></div>
                    </div>
                </section>

                <!-- Withdrawals Section -->
                <section id="withdrawalsSection" style="display: none;">
                    <h2 class="page-title">Gestão de Saques</h2>
                    <div class="list-container">
                        <div class="list-header">
                            <div class="list-title">Saques Pendentes</div>
                            <div class="list-count" id="withdrawalsCount">0</div>
                        </div>
                        <div id="withdrawalsList"></div>
                    </div>
                    
                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-title">Histórico de Saques</div>
                        <div id="withdrawalsHistory"></div>
                    </div>
                </section>

                <!-- Profits/Losses Section -->
                <section id="profitsSection" style="display: none;">
                    <h2 class="page-title">Estatísticas de Lucros/Perdas</h2>
                    
                    <div class="profit-loss-stats">
                        <h3 style="color: var(--text-light); margin-bottom: 15px;">Resumo Financeiro</h3>
                        <div class="profit-loss-grid">
                            <div class="profit-loss-card profit-card">
                                <div class="profit-loss-title">Total Ganho</div>
                                <div class="profit-loss-value" id="totalWins">0 Kz</div>
                                <div style="font-size: 12px; color: var(--text-gray); margin-top: 5px;">
                                    De <span id="totalWinners">0</span> vencedores
                                </div>
                            </div>
                            
                            <div class="profit-loss-card loss-card">
                                <div class="profit-loss-title">Total Perdido</div>
                                <div class="profit-loss-value" id="totalLosses">0 Kz</div>
                                <div style="font-size: 12px; color: var(--text-gray); margin-top: 5px;">
                                    De <span id="totalLosers">0</span> perdedores
                                </div>
                            </div>
                            
                            <div class="profit-loss-card total-card">
                                <div class="profit-loss-title">Lucro Líquido</div>
                                <div class="profit-loss-value" id="netProfit">0 Kz</div>
                                <div style="font-size: 12px; color: var(--text-gray); margin-top: 5px;">
                                    Taxa: <span id="profitRate">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="list-container">
                        <div class="list-title">Detalhes por Usuário</div>
                        <div id="profitsDetails"></div>
                    </div>
                </section>

                <!-- Notifications Section -->
                <section id="notificationsSection" style="display: none;">
                    <h2 class="page-title">Notificações do Sistema</h2>
                    
                    <div class="list-container">
                        <div class="list-header">
                            <div class="list-title">Notificações Recentes</div>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(255, 71, 87, 0.1); color: var(--primary);"
                                    onclick="clearAllNotifications()">
                                <i class="fas fa-trash"></i> Limpar Todas
                            </button>
                        </div>
                        <div id="notificationsList"></div>
                    </div>
                </section>

                <!-- Admin Wallet Section -->
                <section id="adminWalletSection" style="display: none;">
                    <h2 class="page-title">Carteira Administrativa</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: rgba(46, 213, 115, 0.1); color: var(--success);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Saldo da Carteira</div>
                                <div class="stat-value" id="adminWalletBalance">0 Kz</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon" style="background: rgba(255, 71, 87, 0.1); color: var(--danger);">
                                <i class="fas fa-chart-line-down"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">Dinheiro Perdido</div>
                                <div class="stat-value" id="adminLostMoney">0 Kz</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="list-container">
                        <div class="list-title">Transações da Carteira</div>
                        <div id="adminWalletTransactions"></div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <div id="receiptModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('receiptModal')">&times;</button>
            <h2 style="color: var(--text-light); margin-bottom: 20px;">Comprovativo de Depósito</h2>
            <div id="receiptImageContainer" style="text-align: center; margin: 20px 0;">
                <!-- Imagem será carregada aqui -->
            </div>
            <div style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="approveSelectedDeposit()">
                    <i class="fas fa-check"></i> Aprovar Depósito
                </button>
                <button class="btn" style="margin-left: 10px; background: rgba(255, 71, 87, 0.1); color: var(--danger);"
                        onclick="rejectSelectedDeposit()">
                    <i class="fas fa-times"></i> Rejeitar
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Area -->
    <div id="notificationArea"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        // Sistema Administrativo Completo com Robô
        const AdminSystem = {
            config: {
                mode: 'manual',
                chartMode: 'manual', // manual, real ou robot
                tradingActive: true,
                robotActive: false,
                robotInterval: 3000, // 3 segundos
                robotStrength: 1.5,
                robotSensitivity: 10, // 10% de diferença para atuar
                robotMode: 'balanced',
                operationInterval: 15,
                currentOperation: 'POP1',
                operations: [
                    { id: 'POP1', name: 'PREMIER OPERATION', price: 150.50, history: [], payout: 85, icon: 'crown', color: '#FF6B6B' },
                    { id: 'BOP1', name: 'BANTU OPERATION', price: 85.20, history: [], payout: 82, icon: 'globe-africa', color: '#FF5F6D' },
                    { id: 'EOP1', name: '888 OPERATION', price: 120.80, history: [], payout: 88, icon: 'dice', color: '#9D50BB' },
                    { id: 'SOP1', name: 'SPORT OPERATION', price: 95.60, history: [], payout: 86, icon: 'futbol', color: '#00C9FF' }
                ],
                adminProfit: 0
            },
            
            users: [],
            deposits: [],
            withdrawals: [],
            notifications: [],
            adminWallet: {
                balance: 0,
                transactions: []
            },
            
            // Sistema de robô
            robot: {
                active: false,
                interval: null,
                lastDirection: null,
                totalUp: 0,
                totalDown: 0,
                log: []
            },
            
            adminChart: null,
            controlChart: null,
            realTimeInterval: null,
            priceInterval: null,
            autoModeInterval: null,
            
            init() {
                this.loadData();
                this.initCharts();
                this.setupEventListeners();
                this.startAutoUpdates();
                this.updateUI();
                this.checkNotifications();
                this.updateRobotStats();
            },
            
            loadData() {
                // Carregar configurações
                const savedConfig = JSON.parse(localStorage.getItem('admin_config')) || this.config;
                this.config = { ...this.config, ...savedConfig };
                
                // Carregar usuários
                this.users = JSON.parse(localStorage.getItem('trader_users')) || [];
                
                // Carregar notificações
                this.notifications = JSON.parse(localStorage.getItem('admin_notifications')) || [];
                
                // Carregar carteira admin
                this.adminWallet = JSON.parse(localStorage.getItem('admin_wallet')) || { 
                    balance: 0, 
                    transactions: [] 
                };
                
                // Carregar estatísticas
                this.stats = JSON.parse(localStorage.getItem('admin_stats')) || {
                    totalLosses: 0,
                    totalWins: 0,
                    totalPlayers: 0,
                    totalWinners: 0,
                    totalLosers: 0,
                    adminBalance: 0
                };
                
                this.loadAllTransactions();
                this.saveConfig();
            },
            
            loadAllTransactions() {
                this.deposits = [];
                this.withdrawals = [];
                
                this.users.forEach(user => {
                    const userDeposits = JSON.parse(localStorage.getItem(`deposits_${user.id}`)) || [];
                    const userWithdrawals = JSON.parse(localStorage.getItem(`withdrawals_${user.id}`)) || [];
                    const userTrades = JSON.parse(localStorage.getItem(`trades_${user.id}`)) || [];
                    
                    userDeposits.forEach(deposit => {
                        this.deposits.push({
                            ...deposit,
                            userName: user.name,
                            userEmail: user.email,
                            userId: user.id
                        });
                    });
                    
                    userWithdrawals.forEach(withdrawal => {
                        this.withdrawals.push({
                            ...withdrawal,
                            userName: user.name,
                            userEmail: user.email,
                            userId: user.id
                        });
                    });
                    
                    // Calcular perdas do usuário
                    user.totalLosses = userTrades
                        .filter(trade => trade.result === 'loss')
                        .reduce((sum, trade) => sum + trade.amount, 0);
                        
                    user.totalWins = userTrades
                        .filter(trade => trade.result === 'win')
                        .reduce((sum, trade) => sum + (trade.profit || 0), 0);
                });
            },
            
            saveConfig() {
                localStorage.setItem('admin_config', JSON.stringify(this.config));
                localStorage.setItem('trading_config', JSON.stringify({
                    operations: this.config.operations,
                    tradingActive: this.config.tradingActive,
                    chartMode: this.config.chartMode,
                    robotActive: this.config.robotActive
                }));
            },
            
            setupEventListeners() {
                // Botões de direção
                const upBtn = document.getElementById('upBtn');
                const downBtn = document.getElementById('downBtn');
                
                if (upBtn) {
                    upBtn.addEventListener('click', () => this.manualControl('up'));
                }
                
                if (downBtn) {
                    downBtn.addEventListener('click', () => this.manualControl('down'));
                }
                
                // Botões de modo gráfico
                const manualModeBtn = document.getElementById('manualModeBtn');
                const realModeBtn = document.getElementById('realModeBtn');
                const robotModeBtn = document.getElementById('robotModeBtn');
                
                if (manualModeBtn) {
                    manualModeBtn.addEventListener('click', () => this.setChartMode('manual'));
                }
                
                if (realModeBtn) {
                    realModeBtn.addEventListener('click', () => this.setChartMode('real'));
                }
                
                if (robotModeBtn) {
                    robotModeBtn.addEventListener('click', () => this.setChartMode('robot'));
                }
                
                // Botões de status trading
                const tradingOnBtn = document.getElementById('tradingOnBtn');
                const tradingOffBtn = document.getElementById('tradingOffBtn');
                
                if (tradingOnBtn) {
                    tradingOnBtn.addEventListener('click', () => this.setTradingStatus(true));
                }
                
                if (tradingOffBtn) {
                    tradingOffBtn.addEventListener('click', () => this.setTradingStatus(false));
                }
                
                // Seletor de ativos
                const chartAsset = document.getElementById('chartAsset');
                if (chartAsset) {
                    chartAsset.addEventListener('change', (e) => {
                        this.config.currentOperation = e.target.value;
                        this.saveConfig();
                        this.updateCharts();
                        this.updateUI();
                    });
                }
                
                // Controles do robô
                const robotStrength = document.getElementById('robotStrength');
                if (robotStrength) {
                    robotStrength.addEventListener('input', (e) => {
                        this.config.robotStrength = parseFloat(e.target.value);
                        document.getElementById('robotStrengthValue').textContent = e.target.value;
                        this.saveConfig();
                    });
                }
                
                const robotInterval = document.getElementById('robotInterval');
                if (robotInterval) {
                    robotInterval.addEventListener('change', (e) => {
                        this.config.robotInterval = parseInt(e.target.value) * 1000;
                        this.saveConfig();
                        if (this.robot.active) {
                            this.restartRobot();
                        }
                    });
                }
                
                const robotSensitivity = document.getElementById('robotSensitivity');
                if (robotSensitivity) {
                    robotSensitivity.addEventListener('change', (e) => {
                        this.config.robotSensitivity = parseInt(e.target.value);
                        this.saveConfig();
                    });
                }
                
                const robotMode = document.getElementById('robotMode');
                if (robotMode) {
                    robotMode.addEventListener('change', (e) => {
                        this.config.robotMode = e.target.value;
                        this.saveConfig();
                    });
                }
            },
            
            initCharts() {
                // Gráfico admin
                const adminCtx = document.getElementById('adminChart').getContext('2d');
                this.adminChart = this.createChart(adminCtx, 'Gráfico Admin');
                
                // Gráfico de controle
                const controlCtx = document.getElementById('controlChart').getContext('2d');
                this.controlChart = this.createChart(controlCtx, 'Controle');
                
                // Iniciar modo se configurado
                if (this.config.chartMode === 'real') {
                    this.startRealTimeChart();
                } else if (this.config.chartMode === 'robot') {
                    this.showRobotPanel();
                }
            },
            
            createChart(ctx, label) {
                const operation = this.getCurrentOperation();
                const data = this.generateChartData(60, operation.price);
                
                return new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: label,
                            data: data.prices,
                            borderColor: operation.color || '#FF4757',
                            backgroundColor: this.hexToRgba(operation.color || '#FF4757', 0.1),
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 5,
                            pointBackgroundColor: operation.color || '#FF4757',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.05)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.5)' }
                            },
                            y: {
                                grid: { color: 'rgba(255, 255, 255, 0.05)' },
                                ticks: { 
                                    color: 'rgba(255, 255, 255, 0.5)',
                                    callback: function(value) {
                                        return 'Kz ' + value.toFixed(0);
                                    }
                                }
                            }
                        }
                    }
                });
            },
            
            generateChartData(count, basePrice) {
                const labels = [];
                const prices = [];
                let currentPrice = basePrice;
                
                for (let i = count - 1; i >= 0; i--) {
                    const time = new Date(Date.now() - i * 15000);
                    const minutes = time.getMinutes().toString().padStart(2, '0');
                    const seconds = time.getSeconds().toString().padStart(2, '0');
                    labels.push(`${minutes}:${seconds}`);
                    
                    currentPrice += (Math.random() - 0.5) * 2;
                    prices.push(currentPrice);
                }
                
                return { labels, prices };
            },
            
            hexToRgba(hex, alpha) {
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${alpha})`;
            },
            
            setChartMode(mode) {
                this.config.chartMode = mode;
                this.saveConfig();
                
                // Atualizar botões visualmente
                document.getElementById('manualModeBtn').classList.remove('active');
                document.getElementById('realModeBtn').classList.remove('active');
                document.getElementById('robotModeBtn').classList.remove('active');
                
                if (mode === 'manual') {
                    document.getElementById('manualModeBtn').classList.add('active');
                    this.stopRealTimeChart();
                    this.stopRobot();
                    this.hideRobotPanel();
                } else if (mode === 'real') {
                    document.getElementById('realModeBtn').classList.add('active');
                    this.startRealTimeChart();
                    this.stopRobot();
                    this.hideRobotPanel();
                } else if (mode === 'robot') {
                    document.getElementById('robotModeBtn').classList.add('active');
                    this.stopRealTimeChart();
                    this.showRobotPanel();
                }
                
                this.showNotification(`Modo do gráfico alterado para: ${mode === 'manual' ? 'MANUAL' : mode === 'real' ? 'TEMPO REAL' : 'ROBÔ'}`, 'success');
            },
            
            showRobotPanel() {
                document.getElementById('robotControlPanel').style.display = 'block';
                this.updateRobotStats();
            },
            
            hideRobotPanel() {
                document.getElementById('robotControlPanel').style.display = 'none';
            },
            
            startRealTimeChart() {
                this.stopRealTimeChart();
                
                this.realTimeInterval = setInterval(() => {
                    const operation = this.getCurrentOperation();
                    const change = (Math.random() - 0.5) * 3;
                    operation.price += change;
                    
                    if (operation.price < 0.1) {
                        operation.price = 1.0;
                    }
                    
                    this.saveConfig();
                    this.updateCharts();
                    this.updateUI();
                }, 2000);
            },
            
            stopRealTimeChart() {
                if (this.realTimeInterval) {
                    clearInterval(this.realTimeInterval);
                    this.realTimeInterval = null;
                }
            },
            
            // SISTEMA DO ROBÔ
            startRobot() {
                if (this.robot.active) return;
                
                this.robot.active = true;
                this.config.robotActive = true;
                this.saveConfig();
                
                this.updateRobotUI();
                this.showNotification('Robô automático LIGADO!', 'robot');
                this.addLog('Robô iniciado', 'start');
                
                this.robot.interval = setInterval(() => {
                    this.robotCycle();
                }, this.config.robotInterval);
                
                // Primeiro ciclo
                this.robotCycle();
            },
            
            stopRobot() {
                if (!this.robot.active) return;
                
                this.robot.active = false;
                this.config.robotActive = false;
                this.saveConfig();
                
                if (this.robot.interval) {
                    clearInterval(this.robot.interval);
                    this.robot.interval = null;
                }
                
                this.updateRobotUI();
                this.showNotification('Robô automático PARADO!', 'warning');
                this.addLog('Robô parado', 'stop');
            },
            
            restartRobot() {
                this.stopRobot();
                setTimeout(() => this.startRobot(), 500);
            },
            
            robotCycle() {
                // Analisar mercado
                this.analyzeMarket();
                
                // Tomar decisão baseada no balanço
                const decision = this.makeRobotDecision();
                
                if (decision.action !== 'hold') {
                    this.executeRobotAction(decision);
                }
                
                // Atualizar estatísticas
                this.updateRobotStats();
            },
            
            analyzeMarket() {
                let totalUp = 0;
                let totalDown = 0;
                let activeUpCount = 0;
                let activeDownCount = 0;
                
                // Analisar todas as apostas ativas de todos os usuários
                this.users.forEach(user => {
                    const activeTrades = JSON.parse(localStorage.getItem(`active_trades_${user.id}`)) || [];
                    
                    activeTrades.forEach(trade => {
                        if (trade.status === 'active') {
                            if (trade.direction === 'up') {
                                totalUp += trade.amount;
                                activeUpCount++;
                            } else if (trade.direction === 'down') {
                                totalDown += trade.amount;
                                activeDownCount++;
                            }
                        }
                    });
                });
                
                this.robot.totalUp = totalUp;
                this.robot.totalDown = totalDown;
                
                // Atualizar UI
                document.getElementById('robotTotalUp').textContent = `${totalUp.toFixed(2)} Kz`;
                document.getElementById('robotTotalDown').textContent = `${totalDown.toFixed(2)} Kz`;
                document.getElementById('activeUpTrades').textContent = activeUpCount;
                document.getElementById('activeDownTrades').textContent = activeDownCount;
                document.getElementById('activeUpAmount').textContent = `${totalUp.toFixed(2)} Kz`;
                document.getElementById('activeDownAmount').textContent = `${totalDown.toFixed(2)} Kz`;
                
                const balance = totalDown - totalUp;
                document.getElementById('robotBalance').textContent = `${balance.toFixed(2)} Kz`;
                
                return { totalUp, totalDown, balance, activeUpCount, activeDownCount };
            },
            
            makeRobotDecision() {
                const analysis = this.analyzeMarket();
                const { totalUp, totalDown, balance } = analysis;
                
                // Calcular diferença percentual
                const total = totalUp + totalDown;
                let difference = 0;
                let direction = null;
                
                if (total > 0) {
                    if (totalUp > totalDown) {
                        difference = ((totalUp - totalDown) / total) * 100;
                        direction = 'up';
                    } else if (totalDown > totalUp) {
                        difference = ((totalDown - totalUp) / total) * 100;
                        direction = 'down';
                    }
                }
                
                // Tomar decisão baseada na sensibilidade configurada
                if (difference > this.config.robotSensitivity) {
                    // Se mais dinheiro em UP, o robô faz o gráfico DESCER (para a casa ganhar)
                    // Se mais dinheiro em DOWN, o robô faz o gráfico SUBIR
                    const actionDirection = direction === 'up' ? 'down' : 'up';
                    
                    return {
                        action: 'move',
                        direction: actionDirection,
                        strength: this.calculateRobotStrength(difference),
                        reason: `${direction === 'up' ? 'MAIS DINHEIRO EM UP' : 'MAIS DINHEIRO EM DOWN'} (Diferença: ${difference.toFixed(1)}%)`,
                        marketDirection: direction,
                        difference: difference
                    };
                }
                
                return {
                    action: 'hold',
                    reason: `Mercado equilibrado (Diferença: ${difference.toFixed(1)}%)`,
                    marketDirection: direction,
                    difference: difference
                };
            },
            
            calculateRobotStrength(difference) {
                let strength = this.config.robotStrength;
                
                // Ajustar força baseado no modo
                switch(this.config.robotMode) {
                    case 'aggressive':
                        strength *= 1.5;
                        break;
                    case 'conservative':
                        strength *= 0.5;
                        break;
                }
                
                // Aumentar força baseado na diferença
                const diffMultiplier = Math.min(difference / 50, 2); // Máximo 2x
                strength *= (1 + diffMultiplier);
                
                return Math.min(strength, 10); // Limitar a 10
            },
            
            executeRobotAction(decision) {
                if (decision.action !== 'move') return;
                
                const operation = this.getCurrentOperation();
                const oldPrice = operation.price;
                const changeAmount = decision.strength;
                
                if (decision.direction === 'up') {
                    operation.price += changeAmount;
                    this.addLog(`Robô SUBIU preço de ${oldPrice.toFixed(2)} para ${operation.price.toFixed(2)} (${decision.reason})`, 'up');
                } else {
                    operation.price -= changeAmount;
                    if (operation.price < 0.1) operation.price = 0.1;
                    this.addLog(`Robô DESCEU preço de ${oldPrice.toFixed(2)} para ${operation.price.toFixed(2)} (${decision.reason})`, 'down');
                }
                
                this.robot.lastDirection = decision.direction;
                
                // Salvar e atualizar
                this.saveConfig();
                this.updateCharts();
                this.updateUI();
                this.updateRobotDirectionDisplay(decision.direction);
                
                // Processar trades que podem ter sido afetados
                this.processAffectedTrades(decision);
            },
            
            processAffectedTrades(decision) {
                // Processar trades que podem ter expirado com a mudança do robô
                this.users.forEach(user => {
                    const activeTrades = JSON.parse(localStorage.getItem(`active_trades_${user.id}`)) || [];
                    const operation = this.getCurrentOperation();
                    
                    activeTrades.forEach((trade, index) => {
                        if (trade.status === 'active' && trade.remainingSeconds <= 1) {
                            // Simular resultado do trade
                            const priceDiff = operation.price - trade.entryPrice;
                            let result = '';
                            
                            if ((trade.direction === 'up' && priceDiff > 0) || 
                                (trade.direction === 'down' && priceDiff < 0)) {
                                result = 'win';
                                // Usuário ganha - dinheiro sai da carteira do admin
                                let adminWallet = JSON.parse(localStorage.getItem('admin_wallet')) || { balance: 0, transactions: [] };
                                const profit = trade.amount * (trade.payoutPercent / 100);
                                adminWallet.balance -= profit;
                                localStorage.setItem('admin_wallet', JSON.stringify(adminWallet));
                            } else {
                                result = 'loss';
                                // Usuário perde - dinheiro vai para carteira do admin
                                let adminWallet = JSON.parse(localStorage.getItem('admin_wallet')) || { balance: 0, transactions: [] };
                                adminWallet.balance += trade.amount;
                                localStorage.setItem('admin_wallet', JSON.stringify(adminWallet));
                                
                                // Atualizar estatísticas
                                let adminStats = JSON.parse(localStorage.getItem('admin_stats')) || { totalLosses: 0 };
                                adminStats.totalLosses += trade.amount;
                                adminStats.adminBalance += trade.amount;
                                localStorage.setItem('admin_stats', JSON.stringify(adminStats));
                            }
                        }
                    });
                });
            },
            
            forceRobotDirection(direction) {
                if (!this.robot.active) {
                    this.showNotification('Ligue o robô primeiro!', 'warning');
                    return;
                }
                
                const operation = this.getCurrentOperation();
                const oldPrice = operation.price;
                const changeAmount = this.config.robotStrength * 2; // Força dobrada para forçar
                
                if (direction === 'up') {
                    operation.price += changeAmount;
                    this.addLog(`FORÇADO: Robô SUBIU preço de ${oldPrice.toFixed(2)} para ${operation.price.toFixed(2)}`, 'up');
                } else {
                    operation.price -= changeAmount;
                    if (operation.price < 0.1) operation.price = 0.1;
                    this.addLog(`FORÇADO: Robô DESCEU preço de ${oldPrice.toFixed(2)} para ${operation.price.toFixed(2)}`, 'down');
                }
                
                this.saveConfig();
                this.updateCharts();
                this.updateUI();
                this.updateRobotDirectionDisplay(direction);
                this.showNotification(`Robô forçado para ${direction === 'up' ? 'SUBIR' : 'DESCER'}!`, 'robot');
            },
            
            autoBalanceMarket() {
                const analysis = this.analyzeMarket();
                const { totalUp, totalDown } = analysis;
                
                if (totalUp > totalDown) {
                    this.forceRobotDirection('down');
                } else if (totalDown > totalUp) {
                    this.forceRobotDirection('up');
                } else {
                    this.showNotification('Mercado já está balanceado!', 'info');
                }
            },
            
            addLog(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString('pt-PT');
                const logEntry = {
                    time: timestamp,
                    message: message,
                    type: type
                };
                
                this.robot.log.unshift(logEntry);
                if (this.robot.log.length > 50) {
                    this.robot.log.pop();
                }
                
                this.updateRobotLog();
            },
            
            updateRobotLog() {
                const container = document.getElementById('robotLog');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.robot.log.forEach(entry => {
                    const div = document.createElement('div');
                    div.style.padding = '5px 0';
                    div.style.borderBottom = '1px solid rgba(255, 255, 255, 0.05)';
                    
                    let color = 'var(--text-gray)';
                    let prefix = 'ℹ️';
                    
                    if (entry.type === 'up') {
                        color = 'var(--success)';
                        prefix = '⬆️';
                    } else if (entry.type === 'down') {
                        color = 'var(--danger)';
                        prefix = '⬇️';
                    } else if (entry.type === 'start') {
                        color = 'var(--robot-color)';
                        prefix = '🤖';
                    } else if (entry.type === 'stop') {
                        color = 'var(--warning)';
                        prefix = '⏹️';
                    }
                    
                    div.innerHTML = `
                        <span style="color: var(--text-gray); font-size: 10px;">[${entry.time}]</span>
                        <span style="color: ${color}; margin-left: 5px;">${prefix} ${entry.message}</span>
                    `;
                    
                    container.appendChild(div);
                });
            },
            
            updateRobotStats() {
                this.analyzeMarket();
                
                // Atualizar direção atual
                if (this.robot.lastDirection) {
                    document.getElementById('robotDirection').textContent = this.robot.lastDirection === 'up' ? 'SUBINDO ▲' : 'DESCENDO ▼';
                    document.getElementById('robotDirection').style.color = this.robot.lastDirection === 'up' ? 'var(--success)' : 'var(--danger)';
                }
            },
            
            updateRobotUI() {
                const isActive = this.robot.active;
                
                // Atualizar status
                const statusElements = document.querySelectorAll('.robot-status');
                statusElements.forEach(el => {
                    el.textContent = isActive ? 'ATIVO' : 'DESLIGADO';
                    el.className = isActive ? 'robot-status active' : 'robot-status inactive';
                });
                
                // Atualizar botões
                const startButtons = document.querySelectorAll('[id*="StartBtn"], [id*="startRobotBtn"]');
                const stopButtons = document.querySelectorAll('[id*="StopBtn"], [id*="stopRobotBtn"]');
                
                startButtons.forEach(btn => {
                    btn.disabled = isActive;
                    btn.style.opacity = isActive ? '0.5' : '1';
                });
                
                stopButtons.forEach(btn => {
                    btn.disabled = !isActive;
                    btn.style.opacity = !isActive ? '0.5' : '1';
                });
                
                // Atualizar força do robô se estiver ativo
                if (isActive && this.robot.lastDirection) {
                    this.updateRobotDirectionDisplay(this.robot.lastDirection);
                }
            },
            
            updateRobotDirectionDisplay(direction) {
                document.getElementById('robotDirection').textContent = direction === 'up' ? 'SUBINDO ▲' : 'DESCENDO ▼';
                document.getElementById('robotDirection').style.color = direction === 'up' ? 'var(--success)' : 'var(--danger)';
            },
            
            updateCharts() {
                const operation = this.getCurrentOperation();
                const newPrice = operation.price;
                
                this.updateChartData(this.adminChart, newPrice, operation.color);
                this.updateChartData(this.controlChart, newPrice, operation.color);
            },
            
            updateChartData(chart, newPrice, color) {
                if (!chart) return;
                
                chart.data.datasets[0].data.shift();
                chart.data.datasets[0].data.push(newPrice);
                
                const lastIndex = chart.data.datasets[0].data.length - 1;
                const prevIndex = lastIndex - 1;
                const direction = chart.data.datasets[0].data[lastIndex] > chart.data.datasets[0].data[prevIndex];
                
                chart.data.datasets[0].borderColor = direction ? '#2ED573' : '#FF4757';
                chart.data.datasets[0].backgroundColor = direction ? 'rgba(46, 213, 115, 0.1)' : 'rgba(255, 71, 87, 0.1)';
                chart.data.datasets[0].pointBackgroundColor = direction ? '#2ED573' : '#FF4757';
                
                chart.data.labels.shift();
                const now = new Date();
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                chart.data.labels.push(`${minutes}:${seconds}`);
                
                chart.update('none');
            },
            
            getCurrentOperation() {
                return this.config.operations.find(op => op.id === this.config.currentOperation) || this.config.operations[0];
            },
            
            manualControl(direction) {
                const operation = this.getCurrentOperation();
                const changeInput = document.getElementById('changeValue');
                let change = 1.5;
                
                if (changeInput) {
                    change = parseFloat(changeInput.value);
                    if (isNaN(change) || change < 0.1) {
                        change = 0.1;
                        changeInput.value = 0.1;
                    }
                }
                
                const oldPrice = operation.price;
                
                if (direction === 'up') {
                    operation.price += change;
                } else if (direction === 'down') {
                    operation.price -= change;
                    if (operation.price < 0.1) {
                        operation.price = 0.1;
                    }
                }
                
                operation.history.push({
                    time: new Date(),
                    price: operation.price,
                    direction: direction,
                    change: change
                });
                
                if (operation.history.length > 100) {
                    operation.history.shift();
                }
                
                this.saveConfig();
                this.updateUI();
                this.updateCharts();
                
                const changeText = direction === 'up' ? 'subiu' : 'desceu';
                this.showNotification(`${operation.name} ${changeText} de ${oldPrice.toFixed(2)} para ${operation.price.toFixed(2)} Kz`, 'success');
                
                const btn = direction === 'up' ? upBtn : downBtn;
                if (btn) {
                    btn.style.animation = 'pulse 0.5s ease';
                    setTimeout(() => {
                        btn.style.animation = '';
                    }, 500);
                }
            },
            
            setTradingStatus(active) {
                this.config.tradingActive = active;
                this.saveConfig();
                
                document.getElementById('tradingOnBtn').classList.toggle('active', active);
                document.getElementById('tradingOffBtn').classList.toggle('active', !active);
                
                this.showNotification(`Trading ${active ? 'ATIVADO' : 'PAUSADO'}`, active ? 'success' : 'warning');
            },
            
            startAutoUpdates() {
                this.priceInterval = setInterval(() => {
                    this.updateUI();
                    this.updateNotificationsBadge();
                    this.updateRobotStats();
                }, 2000);
                
                setInterval(() => {
                    this.loadAllTransactions();
                    this.updateLists();
                    this.updateProfitStats();
                    this.updateAdminWallet();
                }, 10000);
            },
            
            updateUI() {
                const operation = this.getCurrentOperation();
                
                document.getElementById('currentPrice').textContent = operation.price.toFixed(2);
                document.getElementById('currentAssetName').textContent = operation.name;
                
                document.getElementById('chartAsset').value = this.config.currentOperation;
                
                document.getElementById('adminProfit').textContent = this.stats.adminBalance.toFixed(2);
                document.getElementById('statUsers').textContent = this.users.length;
                document.getElementById('statDeposits').textContent = this.deposits.filter(d => d.status === 'pending').length;
                document.getElementById('statWithdrawals').textContent = this.withdrawals.filter(w => w.status === 'pending').length;
                document.getElementById('statProfitTotal').textContent = this.stats.adminBalance.toFixed(2);
                
                this.updateOperationsList();
            },
            
            updateOperationsList() {
                const container = document.getElementById('operationsList');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.config.operations.forEach((op, index) => {
                    const div = document.createElement('div');
                    div.style.cssText = `
                        background: rgba(255, 255, 255, 0.03);
                        border: 1px solid var(--border-color);
                        border-radius: 8px;
                        padding: 10px;
                        margin-bottom: 8px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;
                    
                    div.innerHTML = `
                        <div>
                            <div style="font-weight: 600; color: var(--text-light);">${op.name}</div>
                            <div style="font-size: 12px; color: var(--text-gray);">
                                Preço: Kz ${op.price.toFixed(2)} | Payout: ${op.payout}%
                            </div>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <input type="number" 
                                   value="${op.price}"
                                   onchange="AdminSystem.updateOperationPrice(${index}, this.value)"
                                   style="width: 80px; padding: 5px; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-color); border-radius: 4px; color: var(--text-light);">
                            <input type="number" 
                                   value="${op.payout}"
                                   onchange="AdminSystem.updateOperationPayout(${index}, this.value)"
                                   style="width: 60px; padding: 5px; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-color); border-radius: 4px; color: var(--text-light);">
                        </div>
                    `;
                    
                    container.appendChild(div);
                });
            },
            
            updateOperationPrice(index, newPrice) {
                newPrice = parseFloat(newPrice);
                if (!isNaN(newPrice) && newPrice > 0) {
                    this.config.operations[index].price = newPrice;
                    this.saveConfig();
                    this.updateCharts();
                }
            },
            
            updateOperationPayout(index, newPayout) {
                newPayout = parseInt(newPayout);
                if (!isNaN(newPayout) && newPayout > 0 && newPayout <= 100) {
                    this.config.operations[index].payout = newPayout;
                    this.saveConfig();
                }
            },
            
            saveTradingConfig() {
                this.saveConfig();
                this.showNotification('Configurações salvas com sucesso!', 'success');
            },
            
            updateLists() {
                this.updateUsersList();
                this.updateDepositsList();
                this.updateWithdrawalsList();
            },
            
            updateUsersList() {
                const container = document.getElementById('usersList');
                const count = document.getElementById('usersCount');
                
                if (this.users.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-gray);">Nenhum usuário registrado</div>';
                    count.textContent = '0';
                    return;
                }
                
                count.textContent = this.users.length.toString();
                container.innerHTML = '';
                
                this.users.forEach(user => {
                    const totalTrades = JSON.parse(localStorage.getItem(`trades_${user.id}`)) || [];
                    const wins = totalTrades.filter(t => t.result === 'win').length;
                    const losses = totalTrades.filter(t => t.result === 'loss').length;
                    const successRate = totalTrades.length > 0 ? Math.round((wins / totalTrades.length) * 100) : 0;
                    
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div style="flex: 1;">
                                <strong style="color: var(--text-light); font-size: 16px;">${user.name}</strong>
                                <div style="font-size: 13px; color: var(--text-gray); margin-top: 2px;">
                                    <i class="fas fa-envelope"></i> ${user.email}
                                </div>
                                <div style="font-size: 12px; color: var(--warning); margin-top: 2px;">
                                    <i class="fas fa-key"></i> Senha: <strong>${user.password}</strong>
                                </div>
                                <div style="font-size: 12px; color: var(--text-gray); margin-top: 2px;">
                                    <i class="fas fa-phone"></i> ${user.phone || 'Não informado'} | 
                                    <i class="fas fa-calendar"></i> ${new Date(user.createdAt).toLocaleDateString('pt-PT')}
                                </div>
                                <div style="display: flex; gap: 15px; margin-top: 8px; font-size: 11px;">
                                    <span style="color: var(--success);">
                                        <i class="fas fa-trophy"></i> ${wins} vitórias
                                    </span>
                                    <span style="color: var(--danger);">
                                        <i class="fas fa-skull"></i> ${losses} derrotas
                                    </span>
                                    <span style="color: var(--info);">
                                        <i class="fas fa-percentage"></i> ${successRate}% taxa
                                    </span>
                                </div>
                            </div>
                            <div style="text-align: right; margin-left: 15px;">
                                <div style="font-weight: 700; color: var(--success); font-size: 18px;">Kz ${user.balance.toFixed(2)}</div>
                                <div style="font-size: 11px; color: var(--text-gray); margin-top: 5px;">
                                    Perdas: Kz ${user.totalLosses || 0}
                                </div>
                                <div style="font-size: 11px; color: var(--success);">
                                    Ganhos: Kz ${user.totalWins || 0}
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap;">
                            <button class="btn" style="padding: 6px 12px; font-size: 11px; background: rgba(46, 213, 115, 0.15); color: var(--success); border: 1px solid rgba(46, 213, 115, 0.3);" 
                                    onclick="editUserBalance(${user.id})">
                                <i class="fas fa-edit"></i> Editar Saldo
                            </button>
                            <button class="btn" style="padding: 6px 12px; font-size: 11px; background: rgba(30, 144, 255, 0.15); color: var(--info); border: 1px solid rgba(30, 144, 255, 0.3);"
                                    onclick="viewUserDetails(${user.id})">
                                <i class="fas fa-eye"></i> Detalhes
                            </button>
                            <button class="btn" style="padding: 6px 12px; font-size: 11px; background: rgba(255, 71, 87, 0.15); color: var(--danger); border: 1px solid rgba(255, 71, 87, 0.3);"
                                    onclick="deleteUser(${user.id})">
                                <i class="fas fa-trash"></i> Excluir
                            </button>
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            updateDepositsList() {
                const container = document.getElementById('depositsList');
                const count = document.getElementById('depositsCount');
                const pending = this.deposits.filter(d => d.status === 'pending');
                
                if (pending.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-gray);">Nenhum depósito pendente</div>';
                    count.textContent = '0';
                    return;
                }
                
                count.textContent = pending.length.toString();
                container.innerHTML = '';
                
                pending.forEach(deposit => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.innerHTML = `
                        <div style="margin-bottom: 10px;">
                            <strong>${deposit.userName}</strong>
                            <div style="font-size: 12px; color: var(--text-gray);">${deposit.userEmail}</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div>
                                <div style="font-size: 14px;">Valor: Kz ${deposit.amount.toFixed(2)}</div>
                                <div style="font-size: 12px; color: var(--text-gray);">Data: ${new Date(deposit.createdAt).toLocaleString('pt-PT')}</div>
                            </div>
                            ${deposit.receipt ? 
                                '<div style="font-size: 12px; color: var(--success);"><i class="fas fa-check"></i> Comprovativo enviado</div>' : 
                                '<div style="font-size: 12px; color: var(--warning);"><i class="fas fa-exclamation"></i> Sem comprovativo</div>'
                            }
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(46, 213, 115, 0.1); color: var(--success);" 
                                    onclick="approveTransaction('deposit', '${deposit.id}', ${deposit.userId})">
                                <i class="fas fa-check"></i> Aprovar
                            </button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(255, 71, 87, 0.1); color: var(--danger);"
                                    onclick="rejectTransaction('deposit', '${deposit.id}', ${deposit.userId})">
                                <i class="fas fa-times"></i> Rejeitar
                            </button>
                            ${deposit.receipt ? `
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(30, 144, 255, 0.1); color: var(--info);"
                                    onclick="viewReceipt('${deposit.id}', '${deposit.receipt}')">
                                <i class="fas fa-image"></i> Ver Comprovativo
                            </button>
                            ` : ''}
                        </div>
                    `;
                    container.appendChild(div);
                });
                
                this.updateDepositsHistory();
            },
            
            updateDepositsHistory() {
                const container = document.getElementById('depositsHistory');
                if (!container) return;
                
                const history = this.deposits
                    .filter(d => d.status !== 'pending')
                    .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                    .slice(0, 20);
                
                if (history.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-gray);">Nenhum depósito processado</div>';
                    return;
                }
                
                container.innerHTML = '';
                
                history.forEach(deposit => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.style.padding = '10px';
                    div.style.marginBottom = '8px';
                    
                    const statusColor = deposit.status === 'approved' ? 'var(--success)' : 'var(--danger)';
                    const statusIcon = deposit.status === 'approved' ? 'fa-check' : 'fa-times';
                    
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 13px; font-weight: 600;">${deposit.userName}</div>
                                <div style="font-size: 11px; color: var(--text-gray);">${new Date(deposit.createdAt).toLocaleDateString('pt-PT')}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 13px; font-weight: 600; color: ${statusColor};">Kz ${deposit.amount.toFixed(2)}</div>
                                <div style="font-size: 11px; color: ${statusColor};">
                                    <i class="fas ${statusIcon}"></i> ${deposit.status === 'approved' ? 'Aprovado' : 'Rejeitado'}
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            updateWithdrawalsList() {
                const container = document.getElementById('withdrawalsList');
                const count = document.getElementById('withdrawalsCount');
                const pending = this.withdrawals.filter(w => w.status === 'pending');
                
                if (pending.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-gray);">Nenhum saque pendente</div>';
                    count.textContent = '0';
                    return;
                }
                
                count.textContent = pending.length.toString();
                container.innerHTML = '';
                
                pending.forEach(withdrawal => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.innerHTML = `
                        <div style="margin-bottom: 10px;">
                            <strong>${withdrawal.userName}</strong>
                            <div style="font-size: 12px; color: var(--text-gray);">${withdrawal.userEmail}</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="font-size: 14px;">Valor: Kz ${withdrawal.amount.toFixed(2)}</div>
                            <div style="font-size: 12px; color: var(--text-gray);">Conta: ${withdrawal.bankAccount}</div>
                            <div style="font-size: 12px; color: var(--text-gray);">Total debitado: Kz ${withdrawal.total.toFixed(2)}</div>
                            <div style="font-size: 12px; color: var(--text-gray);">Data: ${new Date(withdrawal.createdAt).toLocaleString('pt-PT')}</div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(46, 213, 115, 0.1); color: var(--success);" 
                                    onclick="approveTransaction('withdrawal', '${withdrawal.id}', ${withdrawal.userId})">
                                <i class="fas fa-check"></i> Processar
                            </button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px; background: rgba(255, 71, 87, 0.1); color: var(--danger);"
                                    onclick="rejectTransaction('withdrawal', '${withdrawal.id}', ${withdrawal.userId})">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                    `;
                    container.appendChild(div);
                });
                
                this.updateWithdrawalsHistory();
            },
            
            updateWithdrawalsHistory() {
                const container = document.getElementById('withdrawalsHistory');
                if (!container) return;
                
                const history = this.withdrawals
                    .filter(w => w.status !== 'pending')
                    .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                    .slice(0, 20);
                
                if (history.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-gray);">Nenhum saque processado</div>';
                    return;
                }
                
                container.innerHTML = '';
                
                history.forEach(withdrawal => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.style.padding = '10px';
                    div.style.marginBottom = '8px';
                    
                    const statusColor = withdrawal.status === 'approved' ? 'var(--success)' : 'var(--danger)';
                    const statusIcon = withdrawal.status === 'approved' ? 'fa-check' : 'fa-times';
                    
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 13px; font-weight: 600;">${withdrawal.userName}</div>
                                <div style="font-size: 11px; color: var(--text-gray);">${withdrawal.bankAccount}</div>
                                <div style="font-size: 11px; color: var(--text-gray);">${new Date(withdrawal.createdAt).toLocaleDateString('pt-PT')}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 13px; font-weight: 600; color: ${statusColor};">Kz ${withdrawal.amount.toFixed(2)}</div>
                                <div style="font-size: 11px; color: ${statusColor};">
                                    <i class="fas ${statusIcon}"></i> ${withdrawal.status === 'approved' ? 'Processado' : 'Cancelado'}
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            updateProfitStats() {
                let totalWins = 0;
                let totalLosses = 0;
                let totalWinners = 0;
                let totalLosers = 0;
                
                this.users.forEach(user => {
                    const trades = JSON.parse(localStorage.getItem(`trades_${user.id}`)) || [];
                    const userWins = trades.filter(t => t.result === 'win');
                    const userLosses = trades.filter(t => t.result === 'loss');
                    
                    totalWins += userWins.reduce((sum, trade) => sum + (trade.profit || 0), 0);
                    totalLosses += userLosses.reduce((sum, trade) => sum + trade.amount, 0);
                    
                    if (userWins.length > 0) totalWinners++;
                    if (userLosses.length > 0) totalLosers++;
                });
                
                const netProfit = totalLosses - totalWins;
                const profitRate = totalLosses > 0 ? ((netProfit / totalLosses) * 100).toFixed(1) : 0;
                
                document.getElementById('totalWins').textContent = `Kz ${totalWins.toFixed(2)}`;
                document.getElementById('totalLosses').textContent = `Kz ${totalLosses.toFixed(2)}`;
                document.getElementById('netProfit').textContent = `Kz ${netProfit.toFixed(2)}`;
                document.getElementById('totalWinners').textContent = totalWinners;
                document.getElementById('totalLosers').textContent = totalLosers;
                document.getElementById('profitRate').textContent = `${profitRate}%`;
                
                this.updateProfitsDetails();
            },
            
            updateProfitsDetails() {
                const container = document.getElementById('profitsDetails');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.users.forEach(user => {
                    const trades = JSON.parse(localStorage.getItem(`trades_${user.id}`)) || [];
                    const wins = trades.filter(t => t.result === 'win');
                    const losses = trades.filter(t => t.result === 'loss');
                    
                    const totalWins = wins.reduce((sum, trade) => sum + (trade.profit || 0), 0);
                    const totalLosses = losses.reduce((sum, trade) => sum + trade.amount, 0);
                    const netProfit = totalLosses - totalWins;
                    
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.style.padding = '10px';
                    div.style.marginBottom = '8px';
                    
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 14px; font-weight: 600;">${user.name}</div>
                                <div style="font-size: 12px; color: var(--text-gray);">${user.email}</div>
                                <div style="display: flex; gap: 15px; margin-top: 5px; font-size: 11px;">
                                    <span style="color: var(--success);">
                                        <i class="fas fa-trophy"></i> ${wins.length} vitórias (Kz ${totalWins.toFixed(2)})
                                    </span>
                                    <span style="color: var(--danger);">
                                        <i class="fas fa-skull"></i> ${losses.length} perdas (Kz ${totalLosses.toFixed(2)})
                                    </span>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 14px; font-weight: 600; color: ${netProfit >= 0 ? 'var(--success)' : 'var(--danger)'}">
                                    Kz ${Math.abs(netProfit).toFixed(2)}
                                </div>
                                <div style="font-size: 11px; color: var(--text-gray);">
                                    ${netProfit >= 0 ? 'Lucro' : 'Prejuízo'} para plataforma
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            updateAdminWallet() {
                document.getElementById('adminWalletBalance').textContent = `Kz ${this.adminWallet.balance.toFixed(2)}`;
                document.getElementById('adminLostMoney').textContent = `Kz ${this.stats.totalLosses.toFixed(2)}`;
                
                this.updateAdminWalletTransactions();
            },
            
            updateAdminWalletTransactions() {
                const container = document.getElementById('adminWalletTransactions');
                if (!container) return;
                
                const transactions = this.adminWallet.transactions
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                    .slice(0, 20);
                
                if (transactions.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-gray);">Nenhuma transação na carteira</div>';
                    return;
                }
                
                container.innerHTML = '';
                
                transactions.forEach(transaction => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.style.padding = '10px';
                    div.style.marginBottom = '8px';
                    
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 14px; font-weight: 600;">${transaction.description}</div>
                                <div style="font-size: 12px; color: var(--text-gray);">${new Date(transaction.timestamp).toLocaleString('pt-PT')}</div>
                                ${transaction.userName ? `<div style="font-size: 11px; color: var(--warning);">Usuário: ${transaction.userName}</div>` : ''}
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 14px; font-weight: 600; color: ${transaction.amount >= 0 ? 'var(--success)' : 'var(--danger)'}">
                                    ${transaction.amount >= 0 ? '+' : ''}Kz ${Math.abs(transaction.amount).toFixed(2)}
                                </div>
                                <div style="font-size: 11px; color: var(--text-gray);">
                                    Saldo: Kz ${transaction.newBalance.toFixed(2)}
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            checkNotifications() {
                const unreadNotifications = this.notifications.filter(n => !n.isRead).length;
                
                if (unreadNotifications > 0) {
                    document.getElementById('notificationsBadge').textContent = unreadNotifications;
                    document.getElementById('notificationsBadge').style.display = 'flex';
                    
                    // Atualizar outras badges
                    const pendingDeposits = this.deposits.filter(d => d.status === 'pending').length;
                    const pendingWithdrawals = this.withdrawals.filter(w => w.status === 'pending').length;
                    
                    if (pendingDeposits > 0) {
                        document.getElementById('depositsNotifications').textContent = pendingDeposits;
                        document.getElementById('depositsNotifications').style.display = 'flex';
                    }
                    
                    if (pendingWithdrawals > 0) {
                        document.getElementById('withdrawalsNotifications').textContent = pendingWithdrawals;
                        document.getElementById('withdrawalsNotifications').style.display = 'flex';
                    }
                }
                
                this.updateNotificationsList();
            },
            
            updateNotificationsBadge() {
                const unread = this.notifications.filter(n => !n.isRead).length;
                const badge = document.getElementById('notificationsBadge');
                
                if (unread > 0) {
                    badge.textContent = unread > 99 ? '99+' : unread;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            },
            
            updateNotificationsList() {
                const container = document.getElementById('notificationsList');
                if (!container) return;
                
                if (this.notifications.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-gray);">Nenhuma notificação</div>';
                    return;
                }
                
                container.innerHTML = '';
                
                this.notifications.forEach(notification => {
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.style.background = notification.isRead ? 'rgba(255, 255, 255, 0.03)' : 'rgba(255, 165, 2, 0.1)';
                    div.style.border = notification.isRead ? '1px solid var(--border-color)' : '1px solid rgba(255, 165, 2, 0.3)';
                    
                    let icon = 'fa-info-circle';
                    let iconColor = 'var(--info)';
                    
                    switch(notification.type) {
                        case 'user_lost_all':
                            icon = 'fa-skull-crossbones';
                            iconColor = 'var(--danger)';
                            break;
                        case 'deposit_approved':
                            icon = 'fa-money-bill-wave';
                            iconColor = 'var(--success)';
                            break;
                        case 'withdrawal_processed':
                            icon = 'fa-credit-card';
                            iconColor = 'var(--warning)';
                            break;
                        case 'new_user':
                            icon = 'fa-user-plus';
                            iconColor = 'var(--primary)';
                            break;
                        case 'robot_action':
                            icon = 'fa-robot';
                            iconColor = 'var(--robot-color)';
                            break;
                    }
                    
                    div.innerHTML = `
                        <div style="display: flex; align-items: flex-start; gap: 15px;">
                            <div style="color: ${iconColor}; font-size: 20px;">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: var(--text-light); margin-bottom: 5px;">
                                    ${notification.message}
                                </div>
                                <div style="font-size: 12px; color: var(--text-gray);">
                                    ${new Date(notification.timestamp).toLocaleString('pt-PT')}
                                </div>
                                ${notification.userName ? `
                                <div style="font-size: 11px; color: var(--warning); margin-top: 5px;">
                                    <i class="fas fa-user"></i> ${notification.userName}
                                </div>
                                ` : ''}
                            </div>
                            ${!notification.isRead ? `
                            <button class="btn" style="padding: 4px 8px; font-size: 11px; background: rgba(30, 144, 255, 0.1); color: var(--info);"
                                    onclick="markNotificationAsRead('${notification.id}')">
                                <i class="fas fa-check"></i> Lida
                            </button>
                            ` : ''}
                        </div>
                    `;
                    container.appendChild(div);
                });
            },
            
            addNotification(message, type = 'info', userName = null) {
                const notification = {
                    id: Date.now().toString(),
                    message: message,
                    type: type,
                    userName: userName,
                    timestamp: new Date().toISOString(),
                    isRead: false
                };
                
                this.notifications.unshift(notification);
                if (this.notifications.length > 100) {
                    this.notifications.pop();
                }
                
                localStorage.setItem('admin_notifications', JSON.stringify(this.notifications));
                this.updateNotificationsBadge();
                this.showNotification(message, type);
            },
            
            showNotification(message, type) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'robot' ? 'robot' : 'exclamation-triangle'}"></i>
                    <div>${message}</div>
                `;
                
                document.getElementById('notificationArea').appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideIn 0.3s ease reverse';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        };

        // Funções globais para o robô
        function startRobot() {
            AdminSystem.startRobot();
        }

        function stopRobot() {
            AdminSystem.stopRobot();
        }

        function analyzeMarket() {
            const analysis = AdminSystem.analyzeMarket();
            AdminSystem.showNotification(`Mercado analisado: UP: Kz ${analysis.totalUp.toFixed(2)} | DOWN: Kz ${analysis.totalDown.toFixed(2)}`, 'info');
            AdminSystem.addLog(`Análise: UP=${analysis.totalUp.toFixed(2)} DOWN=${analysis.totalDown.toFixed(2)} BALANCE=${analysis.balance.toFixed(2)}`, 'info');
        }

        function autoBalanceMarket() {
            AdminSystem.autoBalanceMarket();
        }

        function forceRobotDirection(direction) {
            AdminSystem.forceRobotDirection(direction);
        }

        // Resto das funções globais permanecem iguais...
        let currentDepositId = null;
        let currentUserId = null;

        function adminLogin() {
            const id = document.getElementById('adminId').value;
            const password = document.getElementById('adminPassword').value;
            
            if (id === '1975' && password === '200718') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                AdminSystem.init();
                AdminSystem.showNotification('Acesso administrativo concedido!', 'success');
            } else {
                AdminSystem.showNotification('Credenciais incorretas!', 'error');
            }
        }

        function adminLogout() {
            AdminSystem.stopRealTimeChart();
            AdminSystem.stopRobot();
            if (AdminSystem.autoModeInterval) {
                clearInterval(AdminSystem.autoModeInterval);
            }
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
        }

        function showSection(section) {
            document.getElementById('dashboardSection').style.display = 'none';
            document.getElementById('tradingSection').style.display = 'none';
            document.getElementById('robotSection').style.display = 'none';
            document.getElementById('usersSection').style.display = 'none';
            document.getElementById('depositsSection').style.display = 'none';
            document.getElementById('withdrawalsSection').style.display = 'none';
            document.getElementById('profitsSection').style.display = 'none';
            document.getElementById('notificationsSection').style.display = 'none';
            document.getElementById('adminWalletSection').style.display = 'none';
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(section + 'Section').style.display = 'block';
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            switch(section) {
                case 'dashboard':
                    AdminSystem.updateUI();
                    break;
                case 'trading':
                    AdminSystem.updateUI();
                    break;
                case 'robot':
                    AdminSystem.updateRobotStats();
                    AdminSystem.updateRobotLog();
                    break;
                case 'users':
                    AdminSystem.updateUsersList();
                    break;
                case 'deposits':
                    AdminSystem.updateDepositsList();
                    break;
                case 'withdrawals':
                    AdminSystem.updateWithdrawalsList();
                    break;
                case 'profits':
                    AdminSystem.updateProfitStats();
                    break;
                case 'notifications':
                    AdminSystem.updateNotificationsList();
                    break;
                case 'adminWallet':
                    AdminSystem.updateAdminWallet();
                    break;
            }
        }

        function editUserBalance(userId) {
            const user = AdminSystem.users.find(u => u.id === userId);
            if (user) {
                const newBalance = prompt(`Editar saldo de ${user.name}:`, user.balance);
                if (newBalance !== null && !isNaN(newBalance)) {
                    user.balance = parseFloat(newBalance);
                    localStorage.setItem('trader_users', JSON.stringify(AdminSystem.users));
                    AdminSystem.updateUsersList();
                    AdminSystem.showNotification(`Saldo de ${user.name} atualizado para Kz ${newBalance}!`, 'success');
                    
                    const transaction = {
                        description: `Ajuste de saldo - ${user.name}`,
                        amount: 0,
                        userName: user.name,
                        timestamp: new Date().toISOString(),
                        newBalance: AdminSystem.adminWallet.balance
                    };
                    AdminSystem.adminWallet.transactions.unshift(transaction);
                    localStorage.setItem('admin_wallet', JSON.stringify(AdminSystem.adminWallet));
                }
            }
        }

        function viewUserDetails(userId) {
            const user = AdminSystem.users.find(u => u.id === userId);
            if (user) {
                const trades = JSON.parse(localStorage.getItem(`trades_${userId}`)) || [];
                const deposits = JSON.parse(localStorage.getItem(`deposits_${userId}`)) || [];
                const withdrawals = JSON.parse(localStorage.getItem(`withdrawals_${userId}`)) || [];
                
                const wins = trades.filter(t => t.result === 'win').length;
                const losses = trades.filter(t => t.result === 'loss').length;
                const totalWins = trades.filter(t => t.result === 'win').reduce((sum, t) => sum + (t.profit || 0), 0);
                const totalLosses = trades.filter(t => t.result === 'loss').reduce((sum, t) => sum + t.amount, 0);
                const successRate = trades.length > 0 ? Math.round((wins / trades.length) * 100) : 0;
                
                const details = `
DETALHES DO USUÁRIO:
====================
Nome: ${user.name}
Email: ${user.email}
Telefone: ${user.phone || 'N/A'}
Senha: ${user.password}
Saldo: Kz ${user.balance.toFixed(2)}
ID: ${user.id}

ESTATÍSTICAS:
============
Total de Trades: ${trades.length}
Vitórias: ${wins} (Kz ${totalWins.toFixed(2)})
Derrotas: ${losses} (Kz ${totalLosses.toFixed(2)})
Taxa de Sucesso: ${successRate}%

TRANSAÇÕES:
===========
Depósitos: ${deposits.length} (Total: Kz ${deposits.reduce((s, d) => s + d.amount, 0).toFixed(2)})
Saques: ${withdrawals.length} (Total: Kz ${withdrawals.reduce((s, w) => s + w.amount, 0).toFixed(2)})

CADASTRO:
=========
Data: ${new Date(user.createdAt).toLocaleString('pt-PT')}
Último login: ${user.lastLogin ? new Date(user.lastLogin).toLocaleString('pt-PT') : 'N/A'}
                `;
                alert(details);
            }
        }

        function deleteUser(userId) {
            if (confirm('Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita.')) {
                const user = AdminSystem.users.find(u => u.id === userId);
                if (user) {
                    AdminSystem.users = AdminSystem.users.filter(u => u.id !== userId);
                    localStorage.setItem('trader_users', JSON.stringify(AdminSystem.users));
                    
                    localStorage.removeItem(`trades_${userId}`);
                    localStorage.removeItem(`deposits_${userId}`);
                    localStorage.removeItem(`withdrawals_${userId}`);
                    localStorage.removeItem(`active_trades_${userId}`);
                    
                    AdminSystem.updateUsersList();
                    AdminSystem.showNotification(`Usuário ${user.name} excluído com sucesso!`, 'success');
                    
                    AdminSystem.addNotification(`Usuário ${user.name} foi excluído do sistema`, 'info', user.name);
                }
            }
        }

        function approveTransaction(type, id, userId) {
            if (type === 'deposit') {
                const deposit = AdminSystem.deposits.find(d => d.id == id);
                if (deposit) {
                    deposit.status = 'approved';
                    
                    const user = AdminSystem.users.find(u => u.id === userId);
                    if (user) {
                        user.balance += deposit.amount;
                        localStorage.setItem('trader_users', JSON.stringify(AdminSystem.users));
                    }
                    
                    const userDeposits = JSON.parse(localStorage.getItem(`deposits_${userId}`)) || [];
                    const depositIndex = userDeposits.findIndex(d => d.id == id);
                    if (depositIndex !== -1) {
                        userDeposits[depositIndex].status = 'approved';
                        localStorage.setItem(`deposits_${userId}`, JSON.stringify(userDeposits));
                    }
                    
                    AdminSystem.showNotification(`Depósito de Kz ${deposit.amount.toFixed(2)} aprovado!`, 'success');
                    
                    AdminSystem.addNotification(`Depósito de Kz ${deposit.amount.toFixed(2)} aprovado para ${deposit.userName}`, 'deposit_approved', deposit.userName);
                    
                    AdminSystem.loadAllTransactions();
                    AdminSystem.updateLists();
                }
            } else if (type === 'withdrawal') {
                const withdrawal = AdminSystem.withdrawals.find(w => w.id == id);
                if (withdrawal) {
                    withdrawal.status = 'approved';
                    
                    const userWithdrawals = JSON.parse(localStorage.getItem(`withdrawals_${userId}`)) || [];
                    const withdrawalIndex = userWithdrawals.findIndex(w => w.id == id);
                    if (withdrawalIndex !== -1) {
                        userWithdrawals[withdrawalIndex].status = 'approved';
                        localStorage.setItem(`withdrawals_${userId}`, JSON.stringify(userWithdrawals));
                    }
                    
                    AdminSystem.showNotification(`Saque de Kz ${withdrawal.amount.toFixed(2)} processado!`, 'success');
                    
                    AdminSystem.addNotification(`Saque de Kz ${withdrawal.amount.toFixed(2)} processado para ${withdrawal.userName}`, 'withdrawal_processed', withdrawal.userName);
                    
                    AdminSystem.loadAllTransactions();
                    AdminSystem.updateLists();
                }
            }
        }

        function rejectTransaction(type, id, userId) {
            if (type === 'deposit') {
                const deposit = AdminSystem.deposits.find(d => d.id == id);
                if (deposit) {
                    deposit.status = 'rejected';
                    
                    const userDeposits = JSON.parse(localStorage.getItem(`deposits_${deposit.userId}`)) || [];
                    const depositIndex = userDeposits.findIndex(d => d.id == id);
                    if (depositIndex !== -1) {
                        userDeposits[depositIndex].status = 'rejected';
                        localStorage.setItem(`deposits_${deposit.userId}`, JSON.stringify(userDeposits));
                    }
                    
                    AdminSystem.showNotification(`Depósito de Kz ${deposit.amount.toFixed(2)} rejeitado!`, 'error');
                    
                    AdminSystem.loadAllTransactions();
                    AdminSystem.updateLists();
                }
            } else if (type === 'withdrawal') {
                const withdrawal = AdminSystem.withdrawals.find(w => w.id == id);
                if (withdrawal) {
                    withdrawal.status = 'rejected';
                    
                    const user = AdminSystem.users.find(u => u.id === withdrawal.userId);
                    if (user) {
                        user.balance += withdrawal.total;
                        localStorage.setItem('trader_users', JSON.stringify(AdminSystem.users));
                    }
                    
                    const userWithdrawals = JSON.parse(localStorage.getItem(`withdrawals_${withdrawal.userId}`)) || [];
                    const withdrawalIndex = userWithdrawals.findIndex(w => w.id == id);
                    if (withdrawalIndex !== -1) {
                        userWithdrawals[withdrawalIndex].status = 'rejected';
                        localStorage.setItem(`withdrawals_${withdrawal.userId}`, JSON.stringify(userWithdrawals));
                    }
                    
                    AdminSystem.showNotification(`Saque de Kz ${withdrawal.amount.toFixed(2)} cancelado!`, 'error');
                    
                    AdminSystem.loadAllTransactions();
                    AdminSystem.updateLists();
                }
            }
        }

        function viewReceipt(depositId, receiptUrl) {
            const deposit = AdminSystem.deposits.find(d => d.id == depositId);
            if (deposit && receiptUrl) {
                currentDepositId = depositId;
                currentUserId = deposit.userId;
                
                const container = document.getElementById('receiptImageContainer');
                container.innerHTML = `
                    <img src="${receiptUrl}" style="max-width: 100%; max-height: 400px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="background: rgba(255, 255, 255, 0.03); padding: 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                        <div style="margin-bottom: 10px;">
                            <strong style="color: var(--text-light);">Usuário:</strong> ${deposit.userName}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong style="color: var(--text-light);">Valor:</strong> Kz ${deposit.amount.toFixed(2)}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong style="color: var(--text-light);">Data:</strong> ${new Date(deposit.createdAt).toLocaleString('pt-PT')}
                        </div>
                    </div>
                `;
                
                document.getElementById('receiptModal').style.display = 'flex';
            } else {
                AdminSystem.showNotification('Comprovativo não disponível', 'warning');
            }
        }

        function approveSelectedDeposit() {
            if (currentDepositId && currentUserId) {
                approveTransaction('deposit', currentDepositId, currentUserId);
                closeModal('receiptModal');
                currentDepositId = null;
                currentUserId = null;
            }
        }

        function rejectSelectedDeposit() {
            if (currentDepositId && currentUserId) {
                rejectTransaction('deposit', currentDepositId, currentUserId);
                closeModal('receiptModal');
                currentDepositId = null;
                currentUserId = null;
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            currentDepositId = null;
            currentUserId = null;
        }

        function markNotificationAsRead(notificationId) {
            const notification = AdminSystem.notifications.find(n => n.id === notificationId);
            if (notification) {
                notification.isRead = true;
                localStorage.setItem('admin_notifications', JSON.stringify(AdminSystem.notifications));
                AdminSystem.updateNotificationsList();
                AdminSystem.updateNotificationsBadge();
            }
        }

        function clearAllNotifications() {
            if (confirm('Deseja limpar todas as notificações?')) {
                AdminSystem.notifications = [];
                localStorage.setItem('admin_notifications', JSON.stringify([]));
                AdminSystem.updateNotificationsList();
                AdminSystem.updateNotificationsBadge();
                AdminSystem.showNotification('Todas as notificações foram limpas!', 'success');
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') adminLogin();
            });
            
            setInterval(() => {
                const users = JSON.parse(localStorage.getItem('trader_users')) || [];
                if (users.length > AdminSystem.users.length) {
                    AdminSystem.loadData();
                    AdminSystem.addNotification('Novo usuário cadastrado no sistema', 'new_user');
                }
            }, 5000);
        });
    </script>
</body>
</html>